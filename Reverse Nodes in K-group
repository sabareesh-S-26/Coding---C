struct ListNode {
      int val;
      struct ListNode *next;
  };
struct ListNode* reverseKGroup(struct ListNode* head, int k) {
    if (!head || k == 1)
        return head;

    struct ListNode dummy;
    dummy.next = head;
    struct ListNode *prevGroupEnd = &dummy;

    while (1) {
        struct ListNode *kth = prevGroupEnd;
        for (int i = 0; i < k; i++) {
            kth = kth->next;
            if (!kth)
                return dummy.next;
        }

        struct ListNode *groupStart = prevGroupEnd->next;
        struct ListNode *nextGroupStart = kth->next;

        struct ListNode *prev = nextGroupStart;
        struct ListNode *curr = groupStart;

        while (curr != nextGroupStart) {
            struct ListNode *temp = curr->next;
            curr->next = prev;
            prev = curr;
            curr = temp;
        }

        prevGroupEnd->next = kth;
        prevGroupEnd = groupStart;
    }
}
